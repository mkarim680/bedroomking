/*
Generated time: June 22, 2024 06:16
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
if(!customElements.get("cart-items")){class a extends HTMLElement{constructor(){super(),"false"===this.dataset.empty&&this.init()}disconnectedCallback(){document.removeEventListener("dispatch:cart-drawer:refresh",this.cartRefreshHandler)}init(){this.fetchRequestOpts={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}},this.cartDrawer=document.getElementById("cart-drawer"),this.itemStatus=document.getElementById("cart-line-item-status"),this.currentTotalItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((e,t)=>e+parseInt(t.value,10),0),this.currentQuantities=[],this.querySelectorAll(".cart-item").forEach(e=>{this.currentQuantities[e.dataset.variantId]=Number(e.querySelector(".qty-input__input").value)}),this.addEventListener("click",this.handleClick.bind(this)),this.addEventListener("change",debounce(this.handleChange.bind(this))),this.cartRefreshHandler=this.refreshCart.bind(this),document.addEventListener("dispatch:cart-drawer:refresh",this.cartRefreshHandler)}handleClick(e){e.target.matches(".js-remove-item")&&(e.preventDefault(),this.updateQuantity(e.target.dataset.index,0))}handleChange(e){this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.name)}async updateQuantity(t,e,r){this.enableLoading(t);var i="line-item-error-"+t,n=document.getElementById(i);document.querySelectorAll(`.cart-errors, .cart-item__error:not([id="${i}"])`).forEach(e=>{e.innerHTML="",e.hidden=!0}),this.fetchRequestOpts.body=JSON.stringify({line:t,quantity:e,sections:this.getSectionsToRender().map(e=>e.section),sections_url:window.location.pathname});try{var s=document.getElementById("cart-item-"+t),c=Number(s.dataset.variantId),o=this.currentTotalItemCount,d=await fetch(theme.routes.cartChange,this.fetchRequestOpts);let i=await d.json();if(!d.ok)throw new Error(i.errors||d.status);var m,u,l,h,y=i.item_count;this.cartDrawer?(this.cartDrawer.querySelector(".drawer__content").classList.toggle("drawer__content--flex",0===y),0===y&&(m=this.cartDrawer.querySelector("product-recommendations"))&&m.remove()):0===y&&((u=this.closest(".cc-main-cart").querySelector(".js-cart-title"))&&(u.style.textAlign="center"),(l=document.getElementById("cart-summary-css"))&&l.remove(),h=document.getElementById("cart-summary"))&&(h.hidden=!0),this.getSectionsToRender().forEach(e=>{var t,r=document.getElementById(e.id);r&&(t=e["selector"],(r.querySelector(t)||r).innerHTML=a.getElementHTML(i.sections[e.section],t))}),this.updateRecommendations(0<i.item_count?i.items[0].product_id:null),this.updateLiveRegions(),this.setFocus(t,y,r),this.dataset.empty=0===y,o!==(this.currentTotalItemCount=y)&&this.dispatchEvent(new CustomEvent("on:line-item:change",{bubbles:!0,detail:{cart:i,variantId:c,oldQuantity:this.currentQuantities[c],newQuantity:Number(e)}})),this.currentQuantities[c]=Number(e),n.innerHTML="",n.hidden=!0}catch(e){/^[0-9]+$/.test(e.message)?n.textContent=theme.strings.cartError:n.textContent=e.message,n.hidden=!1,console.log(e),this.querySelectorAll(".cart-item__loader").forEach(e=>{e.hidden=!0}),this.dispatchEvent(new CustomEvent("on:cart:error",{bubbles:!0,detail:{error:e.message}}));var p=document.getElementById("quantity-"+t);p.value=p.dataset.initialValue,p.closest("quantity-input").currentQty=p.dataset.initialValue}finally{this.classList.remove("pointer-events-none")}}async refreshCart(){var t=document.getElementById("cart-errors");try{var e=this.getSectionsToRender().map(e=>e.section),i=await fetch("?sections="+e);let r=await i.json();if(!i.ok)throw new Error(i.status);this.getSectionsToRender().forEach(e=>{var t=document.getElementById(e.id);t&&((t.querySelector(e.selector)||t).innerHTML=a.getElementHTML(r[e.section],e.selector))});var n=this.querySelector(".cart-item:first-child");this.updateRecommendations(n?n.dataset.productId:null),t.innerHTML="",t.hidden=!0}catch(e){t.textContent=theme.strings.cartError,t.hidden=!1,console.log(e),this.dispatchEvent(new CustomEvent("on:cart:error",{bubbles:!0,detail:{error:e.message}}))}}getSectionsToRender(){let e=[{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"free-shipping-notice",section:"free-shipping-notice",selector:".free-shipping-notice"}];var t;return e=this.cartDrawer?(t=this.cartDrawer.closest(".shopify-section").id.replace("shopify-section-",""),[...e,{id:"cart-items",section:t,selector:"cart-items"},{id:"cart-drawer",section:t,selector:".drawer__footer"}]):[...e,{id:"cart-items",section:this.dataset.section,selector:"cart-items"},{id:"cart-summary",section:document.getElementById("cart-summary").dataset.section,selector:".cart__summary"}]}static getElementHTML(e,t){var r=document.createElement("template"),e=(r.innerHTML=e,r.content.querySelector(t));return e?e.innerHTML:""}enableLoading(e){this.classList.add("pointer-events-none");e=this.querySelector(`#cart-item-${e} .cart-item__loader`);e&&(e.hidden=!1),document.activeElement.blur(),this.itemStatus&&this.itemStatus.setAttribute("aria-hidden","false")}updateRecommendations(e){this.recommendations=this.recommendations||document.getElementById("cart-recommendations"),this.recommendations&&(e?(this.recommendations.dataset.productId=e,this.recommendations.init()):this.recommendations.innerHTML="")}updateLiveRegions(){this.itemStatus.setAttribute("aria-hidden","true");let e=document.getElementById("cart-live-region-text");e.setAttribute("aria-hidden","false"),setTimeout(()=>{e.setAttribute("aria-hidden","true")},1e3)}setFocus(e,t,r){e=document.getElementById("cart-item-"+e);let i;e&&(i=e.querySelector(`[name="${r}"]`)),this.cartDrawer?e&&i?trapFocus(this.cartDrawer,i):0===t?trapFocus(this.cartDrawer.querySelector(".js-cart-empty"),this.cartDrawer.querySelector("a")):this.cartDrawer.querySelector(".cart-item")&&trapFocus(this.cartDrawer,document.querySelector(".js-item-name")):e&&i&&i.focus()}}customElements.define("cart-items",a)}